<form id="uploadForm" enctype="multipart/form-data">
  <input type="file" id="file" required>
  <button type="submit" class="btn-upload">Upload</button>
</form>

<script>
const API_BASE = "https://dropvault-2.onrender.com"; // Backend URL

document.getElementById("uploadForm").addEventListener("submit", async (e) => {
  e.preventDefault();

  const token = localStorage.getItem("token");
  // If no token, we'll attempt session-cookie based auth on the upload request

  const file = document.getElementById("file").files[0];
  if (!file) return alert("‚ö†Ô∏è Please select a file.");

  const form = new FormData();
  form.append("file", file);

  const fetchOptions = {
    method: "POST",
    body: form,
    credentials: 'include' // include session cookie if backend uses session auth
  };

  if (token) {
    fetchOptions.headers = { "Authorization": `Bearer ${token}` };
  }

  const res = await fetch(`${API_BASE}/api/upload/`, fetchOptions);

  if (res.ok) {
    alert("üìÅ File Uploaded Successfully!");
    window.location.href = "/myfiles"; // redirect after upload
  } else {
    const errorText = await res.text();
    alert("‚ùå Upload Failed: " + errorText);
  }
});
</script>
