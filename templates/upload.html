<form id="uploadForm" enctype="multipart/form-data">
  <input type="file" id="file" required>
  <button type="submit" class="btn-upload">Upload</button>
</form>

<script>
const API_BASE = "https://dropvault-2.onrender.com"; // Backend URL

document.getElementById("uploadForm").addEventListener("submit", async (e) => {
  e.preventDefault();

  const token = localStorage.getItem("token");
  if (!token) {
    alert("‚ùå Session expired. Please login again.");
    return location.href = "/login";
  }

  const file = document.getElementById("file").files[0];
  if (!file) return alert("‚ö†Ô∏è Please select a file.");

  const form = new FormData();
  form.append("file", file);

  const res = await fetch(`${API_BASE}/api/upload/`, {
    method: "POST",
    headers: {
      "Authorization": `Bearer ${token}` // üîë correct token format
    },
    body: form
  });

  if (res.ok) {
    alert("üìÅ File Uploaded Successfully!");
    window.location.href = "/myfiles"; // redirect after upload
  } else {
    const errorText = await res.text();
    alert("‚ùå Upload Failed: " + errorText);
  }
});
</script>
